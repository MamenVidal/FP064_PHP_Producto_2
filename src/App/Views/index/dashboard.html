{% extends "page.html" %}

{% block title %}Dashboard{% endblock %}

{% block body %}

    <div class="wrapper">
        {% include 'sidebar.html' ignore missing with {'user': user} %}
        <div class="main-panel">
            
            {% include 'navbar.html' ignore missing with {'flash_messages': flash_messages}  %}

            <div class="content">
                <div class="container-fluid">

                    {% if user.Id_tipo_usuario == 1 %}
                        <!-- Dashboard admin -->
                        <div class="row">
                            <div class="col-12">
                                <div class="card ">
                                    <div class="card-header ">
                                        <h4 class="card-title">Actos</h4>
                                        <a href="/acto-edit" class="btn btn-success float-right">
                                            <i class="nc-icon nc-simple-add"></i> Añadir
                                        </a>
                                        
                                    </div>
                                    <div class="card-body ">
                                        <table class="table table-striped table-hover">
                                            <thead class="thead-dark">
                                                <tr>
                                                    <th>Id Acto</th>
                                                    <th>Fecha</th>
                                                    <th>Hora</th>
                                                    <th>Título</th>
                                                    <th>Descripción Corta</th>
                                                    <th>Número de Asistentes</th>
                                                    <th>Id Tipo Acto</th>
                                                    <th>Descripción Larga</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for acto in actos %}
                                                    <tr>
                                                        <td>{{ acto.Id_acto }}<br>
                                                        <a href="/acto-edit?id={{ acto.Id_acto }}" class="btn btn-primary">
                                                            <i class="nc-icon nc-ruler-pencil"></i>
                                                        </a>
                                                        </td>
                                                        <td>{{ acto.Fecha }}</td>
                                                        <td>{{ acto.Hora }}</td>
                                                        <td>{{ acto.Titulo }}</td>
                                                        <td>{{ acto.Descripcion_corta }}</td>
                                                        <td>{{ acto.Num_asistentes }}</td>
                                                        <td>{{ acto.Id_tipo_acto }}</td>
                                                        <td>{{ acto.Descripcion_larga }}</td>
                                                    </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>                                                                            
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="card ">
                                    <div class="card-header ">
                                        <h4 class="card-title">Users Behavior</h4>
                                        <p class="card-category">24 Hours performance</p>
                                    </div>
                                    <div class="card-body ">
                                        <div id="chartHours" class="ct-chart"></div>
                                    </div>
                                    <div class="card-footer ">
                                        <div class="legend">
                                            <i class="fa fa-circle text-info"></i> Open
                                            <i class="fa fa-circle text-danger"></i> Click
                                            <i class="fa fa-circle text-warning"></i> Click Second Time
                                        </div>
                                        <hr>
                                        <div class="stats">
                                            <i class="fa fa-history"></i> Updated 3 minutes ago
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    
                    </div>
                    <div class="row">

                        <!-- Calendario -->
                        <div class="col-12">
                            <div class="card ">
                                <div id='calendar'></div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                      var calendarEl = document.getElementById('calendar');
                                      var calendar = new FullCalendar.Calendar(calendarEl, {
                                        themeSystem: 'bootstrap5',
                                        locale: 'es',
                                        initialView: 'dayGridMonth',
                                        firstDay: 1,
                                        headerToolbar: {
                                            left: 'prev,next today',
                                            center: 'title',
                                            right: 'dayGridMonth,timeGridWeek,timeGridDay',
                                        },
                                        buttonText: {
                                            today: 'Hoy',
                                            month: 'Mes',
                                            week: 'Memana',
                                            day: 'Día',
                                            list: 'Lista'
                                        },
                                        events: [
                                            {
                                                color: '#ff0000',
                                                title: 'Meeting',
                                                start: '2023-11-12',
                                            },
                                            {
                                                color: '#00ff00',
                                                title: 'Click for Google',
                                                url: '/acto-edit?id=1',
                                                start: '2023-11-28'
                                            }
                                        ]
                                      });
                                      calendar.render();
                                    });
                                  </script>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <footer class="footer">
                <div class="container-fluid">
                    <nav>
                        <p class="copyright text-center">
                            FP064 Desarrollo back-end con PHP, framework MVC y gestor de contenidos
                        </p>
                    </nav>
                </div>
            </footer>

        </div>
    </div>

{% endblock %}
